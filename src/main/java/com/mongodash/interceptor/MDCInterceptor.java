package com.mongodash.interceptor;import javax.servlet.http.HttpServletRequest;import javax.servlet.http.HttpServletResponse;import org.slf4j.MDC;import org.springframework.jmx.export.annotation.ManagedOperation;import org.springframework.jmx.export.annotation.ManagedResource;import org.springframework.util.StringUtils;import org.springframework.web.servlet.handler.HandlerInterceptorAdapter;/** * This interceptor uses MDC to put a wrapper containing the request object. * The user information is appended to the log message. */@ManagedResource(objectName = "mongodash:name=LogMDCInterceptor", description = "Add MDC message to log context.")public class MDCInterceptor extends HandlerInterceptorAdapter {	boolean useMDC = true;	@ManagedOperation(description = "Enable MDC")	public void enableMDC() {		useMDC = true;	}	@ManagedOperation(description = "Disable MDC")	public void disableMDC() {		useMDC = false;	}	private String getRequestContent(HttpServletRequest request) {		StringBuilder content = new StringBuilder();		content.append("url=").append(request.getRequestURL());				String queryString = request.getQueryString();		if (StringUtils.hasText(queryString)) {			content.append("?").append(queryString);		}		String client = request.getRemoteAddr();		if (StringUtils.hasText(client)) {			content.append(";client=").append(client);		}		return content.toString();	}	@Override	public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) {		if (useMDC) {			MDC.put("request", getRequestContent(request));		}		return true;	}	/**	 * Removes the log message from the Log4J MDC after the request is processed.	 */	@Override	public void afterCompletion(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex) throws Exception {		MDC.remove("request");	}}